% Dollarama Annual Report Layout Package
% Extends the base Dollarama template system with split-screen annual report layout
% Usage: \usepackage{dollarama-annual-report-layout}

\ProvidesPackage{dollarama-annual-report-layout}

% Required packages
\RequirePackage{tikz}
\RequirePackage{graphicx}
\RequirePackage{geometry}
\RequirePackage{svg}

% Hero image variable for title page
\newcommand{\heroimage}{} % Default empty
\newcommand{\setheroimage}[1]{\renewcommand{\heroimage}{#1}}

% Header image variables for content sections
\newcommand{\headerimage}{} % Default empty
\newcommand{\setheaderimage}[1]{\renewcommand{\headerimage}{#1}}

% Command to add full-width banner image to any page
\newcommand{\addheaderimage}[1]{
    \vspace{0.5cm}
    
    % Full-width section banner image
    \noindent
    \makebox[\textwidth][c]{%
        \includegraphics[width=\textwidth, height=4cm, keepaspectratio=false]{#1}%
    }
    
    \vspace{1cm}
}

% Custom maketitle command for annual report split-screen layout
\renewcommand{\maketitle}{
    \begin{titlepage}
        \pagecolor{white}
        
        % Create the split-screen layout using tikz
        \begin{tikzpicture}[remember picture, overlay]
            % Left side - content area (white background)
            \fill[white] (current page.north west) rectangle ([xshift=11cm]current page.south west);
            
            % Right side - image area with Dollarama branding
            \fill[DollaramaGreen!15] ([xshift=11cm]current page.north west) rectangle (current page.south east);
            
            % Dollarama Green accent bar on the left
            \fill[DollaramaGreen] (current page.north west) rectangle ([xshift=0.5cm]current page.south west);
            
            % Clip and add hero image to stay within right area only (if provided)
            \ifx\heroimage\empty
                % No image provided - just show background color
            \else
                \begin{scope}
                    \clip ([xshift=11cm]current page.north west) rectangle (current page.south east);
                    \node[anchor=center] at ([xshift=15cm, yshift=-14.84cm]current page.north west) {
                        \includegraphics[width=17.28cm,height=56.16cm,keepaspectratio]{\heroimage}
                    };
                \end{scope}
            \fi
        \end{tikzpicture}
        
        % Content positioned on the left side
        \begin{minipage}[t][24cm][t]{10cm}
            \vspace{1.5cm}
            \hspace{1cm}
            \begin{minipage}{8.5cm}
                % Dollarama Official Logo
                \includesvg[width=6cm]{images/dollarama-official-logo.svg}
                
                \vspace{0.5cm}
                
                % Annual Report subtitle
                {\color{DollaramaGreen}\fontsize{16}{20}\selectfont\bfseries ANNUAL} {\color{DollaramaDarkGreen}\fontsize{16}{20}\selectfont\bfseries REPORT}
                
                \vspace{2cm}
                
                % Main title with Dollarama branding
                {\fontsize{24}{28}\selectfont\bfseries\color{DollaramaGreen} \@title}
                
                \vspace{0.5cm}
                
                % Subtitle (if provided)
                \ifx\@subtitle\undefined
                \else
                    {\fontsize{16}{20}\selectfont\color{DollaramaLightGray} \@subtitle}
                    \vspace{1.5cm}
                \fi
                
                % Dollarama decorative line
                \textcolor{DollaramaGreen}{\rule{8cm}{0.5pt}}
                
                \vspace{2cm}
                
                % Parametric metadata section
                {\fontsize{11}{13}\selectfont\color{DollaramaGreen} DOCUMENT METADATA:}
                
                \vspace{0.8cm}
                
                % Metadata in two columns
                \begin{tabular}{@{}ll}
                    \textbf{Préparé par:} & \@author \\[0.3cm]
                    \textbf{Département:} & \@department \\[0.3cm]
                    \textbf{Date:} & \@date \\[0.3cm]
                    \textbf{Version:} & \@version \\[0.3cm]
                    \textbf{Statut:} & \@status \\
                \end{tabular}
                
                \vfill
                
                % Classification footer
                {\fontsize{10}{12}\selectfont\color{DollaramaGray} \@classification}
                
                \vspace{0.5cm}
                
                % Footer credit
                {\fontsize{10}{12}\selectfont Dollarama Professional Template System}
                
            \end{minipage}
        \end{minipage}
        
    \end{titlepage}
    
    % Reset page style for content pages
    \restoregeometry
}