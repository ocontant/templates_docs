% Dollarama Financial Performance Section Template
% Parametric template for financial sections with header images and metrics
% Usage: \usepackage{dollarama-section-financial}
%        \dollaramafinancialperformance{title}{subtitle}{content}{headerimage}

\ProvidesPackage{dollarama-section-financial}

% Required packages
\RequirePackage{tikz}
\RequirePackage{graphicx}
\RequirePackage{array}
\RequirePackage{booktabs}

% Financial Performance Section Command
% Parameters: {section_title}{section_subtitle}{content_text}{header_image_path}
\newcommand{\dollaramasectionfinancial}[4]{
    \clearpage
    
    % Add banner image using simple approach
    \noindent
    \makebox[\textwidth][c]{%
        \includegraphics[width=\textwidth, height=4cm, keepaspectratio=false]{#4}%
    }
    \vspace{0.2cm}
    
    % Section header with financial branding
    \begin{center}
        {\fontsize{28}{34}\selectfont\bfseries\color{DollaramaGreen} #1}
        
        \vspace{0.5cm}
        
        % Subtitle if provided
        \ifx\relax#2\relax
        \else
            {\fontsize{16}{20}\selectfont\color{DollaramaLightGray} #2}
            \vspace{0.5cm}
        \fi
        
        % Double line for financial emphasis
        \textcolor{DollaramaGreen}{\rule{12cm}{1.5pt}}
        \vspace{0.1cm}
        \textcolor{DollaramaYellow}{\rule{12cm}{0.5pt}}
    \end{center}
    
    \vspace{1.5cm}
    
    % Content area
    \begin{flushleft}
        {\fontsize{12}{16}\selectfont #3}
    \end{flushleft}
}

% Financial metrics display box
\newcommand{\dollaramafinancialmetrics}[4]{
    \vspace{1.5cm}
    
    \begin{center}
        \begin{tikzpicture}
            \node[draw=DollaramaGreen, fill=DollaramaGreen!3, rounded corners=8pt, 
                  text width=\textwidth-1cm, inner sep=1.5cm] {
                
                % Title
                {\fontsize{14}{18}\selectfont\bfseries\color{DollaramaGreen} KEY FINANCIAL METRICS}
                
                \vspace{1cm}
                
                % Metrics grid
                \begin{tabular}{@{}*{4}{>{\centering\arraybackslash}p{3cm}}@{}}
                    {\fontsize{20}{24}\selectfont\bfseries\color{DollaramaDarkGreen} #1} & 
                    {\fontsize{20}{24}\selectfont\bfseries\color{DollaramaDarkGreen} #2} & 
                    {\fontsize{20}{24}\selectfont\bfseries\color{DollaramaDarkGreen} #3} & 
                    {\fontsize{20}{24}\selectfont\bfseries\color{DollaramaDarkGreen} #4} \\[0.3cm]
                    
                    {\fontsize{10}{12}\selectfont\color{DollaramaGray} TOTAL REVENUE} & 
                    {\fontsize{10}{12}\selectfont\color{DollaramaGray} REVENUE GROWTH} & 
                    {\fontsize{10}{12}\selectfont\color{DollaramaGray} EBITDA MARGIN} & 
                    {\fontsize{10}{12}\selectfont\color{DollaramaGray} STORE COUNT} \\
                \end{tabular}
            };
        \end{tikzpicture}
    \end{center}
    
    \vspace{1cm}
}

% Revenue growth subsection template
\newcommand{\dollaramarevenueanalysis}[2]{
    \vspace{1cm}
    
    % Subsection title with financial accent
    {\fontsize{18}{22}\selectfont\bfseries\color{DollaramaDarkGreen} #1}
    
    \vspace{0.3cm}
    \textcolor{DollaramaYellow}{\rule{8cm}{0.8pt}}
    \vspace{0.8cm}
    
    % Content
    {\fontsize{11}{15}\selectfont #2}
}

% Market leadership callout box
\newcommand{\dollaramamarketleadership}[1]{
    \vspace{1cm}
    
    \begin{tikzpicture}
        \node[draw=DollaramaYellow, fill=DollaramaYellow!8, rounded corners=5pt, 
              text width=\textwidth-2cm, inner sep=1cm] {
            {\fontsize{12}{16}\selectfont\bfseries\color{DollaramaDarkGreen} Market Leadership:}
            
            \vspace{0.3cm}
            
            {\fontsize{11}{15}\selectfont #1}
        };
    \end{tikzpicture}
    
    \vspace{1cm}
}