% Package Dollarama Business Components
% Commandes et environnements pour documents d'affaires Dollarama
% Auteur: Architecture Team Dollarama
% Version: 1.0

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{dollarama-business}[2025/01/09 v1.0 Dollarama Business Components]

% Packages requis
\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{array}
\RequirePackage{longtable}
\RequirePackage{colortbl}
\RequirePackage{float}
\RequirePackage{enumitem}
\RequirePackage{tikz}
\RequirePackage{tcolorbox}
\tcbuselibrary{breakable,skins}

% Chargement des bibliothèques TikZ
\usetikzlibrary{positioning,shapes,arrows}

% Configuration pour éviter que les couleurs de lignes masquent les bordures
\setlength{\arrayrulewidth}{0.5pt}
\setlength{\tabcolsep}{6pt}

% ===============================================
% COMMANDES POUR RÉSUMÉ EXÉCUTIF FLEXIBLE
% ===============================================

% Environnement pour résumé exécutif flexible
\newenvironment{executivesummaryenv}{
    \phantomsection
    \section*{\dollaramaExecutiveSummary}
    \addcontentsline{toc}{section}{\dollaramaExecutiveSummary}
    \begin{tcolorbox}[
        colback=DollaramaGreen!5,
        colframe=DollaramaGreen,
        boxrule=2pt,
        arc=3pt,
        breakable,
        enhanced
    ]
}{
    \end{tcolorbox}
}

% ===============================================
% STYLES DE TABLEAUX STANDARDISÉS
% ===============================================

% Commande pour en-tête de tableau standard avec contraste amélioré
\newcommand{\dollaramatabheader}{\rowcolor{DollaramaGreen!80}}

% Commande pour text d'en-tête de tableau
\newcommand{\dollaramatabheadertext}[1]{\textbf{\color{white}#1}}

% Commande pour en-tête de tableau alternatif (jaune)
\newcommand{\dollaramatabheaderalt}{\rowcolor{DollaramaYellow!90}}

% Commande pour text d'en-tête de tableau alternatif (texte noir)
\newcommand{\dollaramatabheaderaltext}[1]{\textbf{\color{black}#1}}

% Commande pour en-tête de tableau critique (rouge foncé)
\newcommand{\dollaramatabheadercritical}{\rowcolor{red!80}}

% ===============================================
% COMMANDES DE SECTIONS BUSINESS
% ===============================================

% Boîte de résumé exécutif stylisée
% Usage: \executivesummarybox{contenu}
\newcommand{\executivesummarybox}[1]{
    \begin{tcolorbox}[
        colback=DollaramaGreen!5,
        colframe=DollaramaGreen,
        boxrule=2pt,
        arc=3pt,
        breakable,
        enhanced
    ]
    #1
    \end{tcolorbox}
}

% Commande pour résumé exécutif paramétrable avec 5 sections
% Usage: \executivesummary{problème}{solution}{bénéfices}{financier}{recommandation}
\newcommand{\executivesummary}[5]{
    \phantomsection
    \section*{\dollaramaExecutiveSummary}
    \addcontentsline{toc}{section}{\dollaramaExecutiveSummary}
    \begin{tcolorbox}[
        colback=DollaramaGreen!5,
        colframe=DollaramaGreen,
        boxrule=2pt,
        arc=3pt,
        breakable,
        enhanced
    ]
    
    \execsection{\dollaramaProblem}
    #1
    
    \vspacesmall
    \execsection{\dollaramaProposedSolution}
    #2
    
    \vspacesmall
    \execsection{\dollaramaKeyBenefits}
    #3
    
    \vspacesmall
    \execsection{\dollaramaFinancialImpact}
    #4
    
    \vspacesmall
    \execsection{\dollaramaRecommendation}
    #5
    
    \end{tcolorbox}
}

% Commande pour formater les sous-sections
\newcommand{\execsection}[1]{\textbf{\color{DollaramaGreen}#1}\\[0.5em]}

% ===============================================
% COMMANDES FINANCIÈRES
% ===============================================

% Liste financière sans indentation pour alignement parfait
\newenvironment{financialsummary}{%
    \setlength{\parindent}{0pt}%
    \begin{list}{}{%
        \setlength{\leftmargin}{0pt}%
        \setlength{\rightmargin}{0pt}%
        \setlength{\listparindent}{0pt}%
        \setlength{\itemindent}{0pt}%
        \setlength{\topsep}{0pt}%
        \setlength{\parsep}{0.3\baselineskip}%
        \setlength{\itemsep}{0pt}%
    }%
}{%
    \end{list}%
}

% Commande pour les éléments financiers
\newcommand{\finitem}[1]{\item #1}

% Métriques financières clés
\newcommand{\keyfinancialmetrics}[4]{
    \vspace{1em}
    \begin{center}
    \fcolorbox{DollaramaGreen}{DollaramaGreen!10}{%
    \begin{minipage}{0.9\textwidth}
    \vspace{0.5em}
    \begin{center}
    {\Large\bfseries\color{DollaramaGreen} INDICATEURS FINANCIERS CLÉS}
    \end{center}
    \vspace{0.5em}
    
    \begin{tabular}{p{0.22\textwidth}p{0.22\textwidth}p{0.22\textwidth}p{0.22\textwidth}}
    \centering
    \fcolorbox{DollaramaYellow}{white}{%
    \begin{minipage}{0.2\textwidth}
    \centering
    \textbf{VAN}\\
    \vspace{0.2em}
    {\Large\color{DollaramaGreen}#1}
    \end{minipage}
    } & 
    \centering
    \fcolorbox{DollaramaYellow}{white}{%
    \begin{minipage}{0.2\textwidth}
    \centering
    \textbf{TRI}\\
    \vspace{0.2em}
    {\Large\color{DollaramaGreen}#2}
    \end{minipage}
    } &
    \centering
    \fcolorbox{DollaramaYellow}{white}{%
    \begin{minipage}{0.2\textwidth}
    \centering
    \textbf{Payback}\\
    \vspace{0.2em}
    {\Large\color{DollaramaGreen}#3}
    \end{minipage}
    } &
    \centering
    \fcolorbox{DollaramaYellow}{white}{%
    \begin{minipage}{0.2\textwidth}
    \centering
    \textbf{ROI}\\
    \vspace{0.2em}
    {\Large\color{DollaramaGreen}#4}
    \end{minipage}
    }
    \end{tabular}
    
    \vspace{0.5em}
    \end{minipage}
    }
    \end{center}
    \vspace{1em}
}

% ===============================================
% ENVIRONNEMENTS DE TABLES STYLISÉES
% ===============================================

% Table de coûts Dollarama
\newenvironment{dollaramacosttable}[2]{
    \begin{table}[H]
    \centering
    \caption{#1}
    \label{#2}
    \begin{tabular}{|p{0.4\textwidth}|r|r|r|}
    \hline
    \dollaramatabheader
    \dollaramatabheadertext{\dollaramaElement} & 
    \dollaramatabheadertext{\dollaramaQuantity} & 
    \dollaramatabheadertext{\dollaramaUnitCost} & 
    \dollaramatabheadertext{\dollaramaTotal} \\
    \hline
}{
    \hline
    \end{tabular}
    \end{table}
}

% Table de flux de trésorerie
\newenvironment{dollaramacashflowtable}[2]{
    \begin{table}[H]
    \centering
    \caption{#1}
    \label{#2}
    \begin{tabular}{|l|r|r|r|r|r|r|}
    \hline
    \dollaramatabheader
    \dollaramatabheadertext{\dollaramaElement} & 
    \dollaramatabheadertext{Année 0} & 
    \dollaramatabheadertext{Année 1} & 
    \dollaramatabheadertext{Année 2} & 
    \dollaramatabheadertext{Année 3} & 
    \dollaramatabheadertext{Année 4} & 
    \dollaramatabheadertext{Année 5} \\
    \hline
}{
    \end{tabular}
    \end{table}
}

% Table de comparaison d'options
\newenvironment{dollaramacomparisontable}[2]{
    \begin{table}[H]
    \centering
    \caption{#1}
    \label{#2}
    \begin{tabular}{|p{0.35\textwidth}|r|r|r|}
    \hline
    \dollaramatabheader
    \dollaramatabheadertext{\dollaramaCriterion} & 
    \dollaramatabheadertext{Option 1} & 
    \dollaramatabheadertext{Option 2} & 
    \dollaramatabheadertext{Différence} \\
    \hline
}{
    \end{tabular}
    \end{table}
}

% ===============================================
% COMMANDES UTILITAIRES
% ===============================================

% Lignes de tables stylisées
\newcommand{\costrow}[4]{#1 & #2 & #3 & #4 \\ \hline}
\newcommand{\altcostrow}[4]{#1 & #2 & #3 & #4 \\ \hline}
\newcommand{\totalrow}[2]{\textbf{#1} & & & \textbf{#2} \\ \hline}

% Scores de risque colorés
\newcommand{\scorelow}[1]{\cellcolor{green!30}\textbf{#1}}
\newcommand{\scoremedium}[1]{\cellcolor{yellow!50}\textbf{#1}}
\newcommand{\scorehigh}[1]{\cellcolor{red!30}\textbf{#1}}

% ===============================================
% BOÎTES D'INFORMATION STYLISÉES
% ===============================================

% Boîte de mise en évidence
\newcommand{\highlightbox}[1]{
    \vspace{0.5em}
    \begin{tcolorbox}[
        colback=DollaramaYellow!20,
        colframe=DollaramaYellow,
        boxrule=1pt,
        arc=3pt,
        left=10pt,
        right=10pt,
        top=8pt,
        bottom=8pt
    ]
    #1
    \end{tcolorbox}
    \vspace{0.5em}
}

% Boîte d'information
\newcommand{\infobox}[1]{
    \vspace{0.5em}
    \begin{tcolorbox}[
        colback=DollaramaGreen!10,
        colframe=DollaramaGreen,
        boxrule=1pt,
        arc=3pt,
        left=10pt,
        right=10pt,
        top=8pt,
        bottom=8pt,
        lefttitle=10pt
    ]
    #1
    \end{tcolorbox}
    \vspace{0.5em}
}

% Boîte d'avertissement
\newcommand{\warningbox}[1]{
    \vspace{0.5em}
    \begin{tcolorbox}[
        colback=red!10,
        colframe=red,
        boxrule=1pt,
        arc=3pt,
        left=10pt,
        right=10pt,
        top=8pt,
        bottom=8pt,
        lefttitle=10pt
    ]
    #1
    \end{tcolorbox}
    \vspace{0.5em}
}

% ===============================================
% COMMANDES DE TIMELINE ET JALONS
% ===============================================

% Tableau de bord projet
\newcommand{\projectdashboard}[4]{
    \vspace{1em}
    \begin{center}
    \fcolorbox{DollaramaGreen}{DollaramaGreen!5}{%
    \begin{minipage}{0.9\textwidth}
    \vspace{0.5em}
    \begin{center}
    {\Large\bfseries\color{DollaramaGreen} TABLEAU DE BORD PROJET}
    \end{center}
    \vspace{0.5em}
    
    \begin{tabular}{p{0.22\textwidth}p{0.22\textwidth}p{0.22\textwidth}p{0.22\textwidth}}
    \centering
    \fcolorbox{DollaramaGreen}{white}{%
    \begin{minipage}{0.2\textwidth}
    \centering
    \textbf{Durée}\\
    \vspace{0.2em}
    {\Large\color{DollaramaGreen}#1}
    \end{minipage}
    } & 
    \centering
    \fcolorbox{DollaramaYellow}{white}{%
    \begin{minipage}{0.2\textwidth}
    \centering
    \textbf{Budget}\\
    \vspace{0.2em}
    {\Large\color{DollaramaGreen}#2}
    \end{minipage}
    } &
    \centering
    \fcolorbox{blue}{white}{%
    \begin{minipage}{0.2\textwidth}
    \centering
    \textbf{\dollaramaMilestones}\\
    \vspace{0.2em}
    {\Large\color{blue}#3}
    \end{minipage}
    } &
    \centering
    \fcolorbox{orange}{white}{%
    \begin{minipage}{0.2\textwidth}
    \centering
    \textbf{Équipes}\\
    \vspace{0.2em}
    {\Large\color{orange}#4}
    \end{minipage}
    }
    \end{tabular}
    
    \vspace{0.5em}
    \end{minipage}
    }
    \end{center}
    \vspace{1em}
}

% ===============================================
% COMMANDES DE FORMATAGE FINANCIER
% ===============================================

% Formatage monétaire
\newcommand{\currency}[1]{\textbf{\$#1}}
\newcommand{\percentage}[1]{\textbf{#1\%}}
\newcommand{\positive}[1]{\textcolor{DollaramaGreen}{\textbf{+\$#1}}}
\newcommand{\negative}[1]{\textcolor{red}{\textbf{-\$#1}}}

% ===============================================
% ESPACEMENT ET SÉPARATEURS
% ===============================================

% Espacements
\newcommand{\vspacesmall}{\vspace{0.5em}}
\newcommand{\vspacemedium}{\vspace{1em}}
\newcommand{\vspacelarge}{\vspace{2em}}
\newcommand{\hspacesmall}{\hspace{0.5em}}
\newcommand{\hspacemedium}{\hspace{1em}}
\newcommand{\hspacelarge}{\hspace{2em}}

% Séparateur horizontal stylisé
\newcommand{\dollaramaseparator}{
    \vspace{1em}
    \begin{center}
    \textcolor{DollaramaGreen}{\rule{0.3\textwidth}{2pt}}
    \end{center}
    \vspace{1em}
}

% ===============================================
% COMMANDES POUR FORMATAGE DE TEXTE
% ===============================================

% Commande pour sous-titres avec espacement amélioré
\newcommand{\subheading}[1]{\vspace{0.5em}\textbf{#1}\vspace{0.3em}}

% ===============================================
% CONFIGURATIONS DES LISTES
% ===============================================

% Configuration des listes avec espacement amélioré et indentation
\setlist[itemize,1]{
    leftmargin=2em,
    topsep=0.8em,
    parsep=0.2em,
    itemsep=0.3em,
    after=\vspace{0.8em},
    label=\textbullet
}

\setlist[itemize,2]{
    leftmargin=3em,
    topsep=0.3em,
    parsep=0.1em,
    itemsep=0.2em,
    after=\vspace{0.5em},
    label=$\circ$
}

\setlist[itemize,3]{
    leftmargin=4em,
    topsep=0.3em,
    parsep=0.1em,
    itemsep=0.2em,
    after=\vspace{0.5em},
    label=$\blacksquare$
}

\setlist[enumerate,1]{
    leftmargin=2em,
    topsep=0.8em,
    parsep=0.2em,
    itemsep=0.3em
}

\setlist[enumerate,2]{
    leftmargin=3em,
    topsep=0.3em,
    parsep=0.1em,
    itemsep=0.2em
}

\setlist[enumerate,3]{
	leftmargin=4em,
	topsep=0.3em,
	parsep=0.1em,
	itemsep=0.2em
}

% Fin du package
\endinput